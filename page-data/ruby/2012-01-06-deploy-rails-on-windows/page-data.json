{"componentChunkName":"component---src-templates-blog-post-js","path":"/ruby/2012-01-06-deploy-rails-on-windows/","result":{"data":{"site":{"siteMetadata":{"title":"Wlon X Blog"}},"markdownRemark":{"id":"4fbf9dee-a7ab-52ff-a84e-e09fbf5228b5","excerpt":"###转自\r\nkloboHYZ 由于 mongrel 已经年久失修、不支持最新的 1.9.2 版本了、所以现在使用 thin 作为 rails 服务器、再加上 nginx 作反向代理、\r\n首先安装 thin 吧、在 windows 平台下、需要先安装 eventmachine、否则不能安装 thin…","html":"<p>###转自\r\n<a href=\"http://www.cnblogs.com/klobohyz/archive/2011/12/27/2303450.html\">kloboHYZ</a></p>\n<p>由于 mongrel 已经年久失修、不支持最新的 1.9.2 版本了、所以现在使用 thin 作为 rails 服务器、再加上 nginx 作反向代理、\r\n首先安装 thin 吧、在 windows 平台下、需要先安装 eventmachine、否则不能安装 thin 服务器</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">gem install eventmachine --pre\r\ngem install thin</code></pre></div>\n<p>安装完成后只需要在 rails 的项目目录上输入 thin start 就可以启动 thin 服务器了、</p>\n<p>P.S.:有时候启动 thin 的时候会遇到这种错误、You have already activated rack 1.3.0, but your Gemfile requires rack 1.2.3.\r\n这是因为迩安装了多个 rack 版本、环境造成混乱、请卸载掉不需要的版本或者修改了 Gemfile 再执行一次 bundle install</p>\n<p>接着莪们配置一下 nginx 吧、首先去 nginx 的官网找来 nginx 的 windows 版本、传送门：<a href=\"http://wiki.nginx.org/Install%E3%80%81%E4%B8%8B%E8%BD%BD%E5%AE%8C%E6%88%90%E5%90%8E%E8%A7%A3%E5%8E%8B%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%E4%BA%86%E3%80%81%E8%BF%9B%E5%85%A5nginx%E7%9A%84conf%E7%9B%AE%E5%BD%95%E3%80%81%E6%89%93%E5%BC%80nginx.conf%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E4%BB%A5%E4%B8%8B%E9%85%8D%E7%BD%AE%E3%80%81\">http://wiki.nginx.org/Install、下载完成后解压就可以使用了、进入nginx的conf目录、打开nginx.conf文件进行以下配置、</a></p>\n<p>{% highlight Nginx config files %}\r\nworker_processes 1;\r\nerror_log C:/StandAlone/nginx/logs/error.log;\r\nevents {\r\nworker_connections 1024;\r\n}\r\nhttp {\r\ninclude mime.types;\r\ndefault_type application/octet-stream;\r\nlog_format main ‘$remote_addr - $remote_user [$time_local] “$request” ’\r\n‘$status $body_bytes_sent “$http_referer” ’\r\n’“$http_user_agent” “$http_x_forwarded_for”‘;</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"> sendfile        on;\r\n #keepalive_timeout  0;\r\n keepalive_timeout  65;\r\n #gzip  on;\r\n include C:/StandAlone/nginx/sites_enabled/*.txt;</code></pre></div>\n<p>}\r\n{% endhighlight %}</p>\n<p>注意 error_log、include 一定要切换成迩自己的实际目录、其中 include 狠重要、这个意思是从这个目录时加载其它外部配置、按着配置文件、莪们在 nginx 目录下新建 sites_enabled 文件夹吧、接下来在里面建立 mystandaloneapp.com.txt 文件、输入以下内容</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">upstream mystandaloneapp {\r\n     server 127.0.0.1:3000;\r\n }\r\n\r\n server {\r\n     listen       80;\r\n     server_name  localhost;\r\n     #charset koi8-r;\r\n\r\n     access_log C:/StandAlone/www/mystandaloneapp.com/log/access.log;\r\n     error_log  C:/StandAlone/www/mystandaloneapp.com/log/error.log;\r\n     root       C:/StandAlone/www/mystandaloneapp.com;\r\n     index      index.html;\r\n\r\n     location / {\r\n         proxy_set_header  X-Real-IP  $remote_addr;\r\n         proxy_set_header  X-Forwarded-For $proxy_add_x_forwarded_for;\r\n         proxy_set_header  Host $http_host;\r\n         proxy_redirect    off;\r\n         try_files C:/StandAlone/www/maintenance.html $uri $uri/index.html $uri.html @ruby;\r\n     }\r\n\r\n     location @ruby {\r\n         proxy_pass http://mystandaloneapp;\r\n     }\r\n }</code></pre></div>\n<p>这里的配置就是把 thin 的 3000 端口转化成正常的 80 端口、、注意目录都要填写迩的实际目录、然后运行 nginx 命令便可以成功运行了</p>\n<p>Nginx 的命令</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">nginx -s [ stop | quit | reopen | reload ]</code></pre></div>","frontmatter":{"title":"Deploy rails on windows","date":"January 06, 2012","description":""}}},"pageContext":{"slug":"/ruby/2012-01-06-deploy-rails-on-windows/","previous":null,"next":{"fields":{"slug":"/ruby/2012-03-22-asp-dot-net-mvc-get-current-url-controller-action/"},"frontmatter":{"title":"ASP.NET MVC 中获得当前的URL、Controller、Action"}}}},"staticQueryHashes":["2955840356","3316101980"]}